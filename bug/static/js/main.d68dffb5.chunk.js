(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t,n){},189:function(e,t,n){},192:function(e,t,n){"use strict";n.r(t);var r,a=n(0),o=n.n(a),i=n(29),c=n.n(i),u=n(16),l=n(5),s=n(51),p=n(15),h=n(13),y=n(50),f=n.n(y);!function(e){e.None="",e.PlayerA="1",e.PlayerB="2"}(r||(r={}));var d=function(e,t){return Object(p.a)(Array(t)).map(function(t){return Object(p.a)(Array(e)).map(function(e){return r.None})})},b=function(e,t,n){for(var a=e.length-1;a>=0;--a)if(e[a][t]===r.None){var o=Object(p.a)(e).map(function(e){return Object(p.a)(e)});return o[a][t]=n,o}throw new Error("Unable to play: invalid position")},m=function(e,t,n){for(var a=0;e[a][t]===r.None;++a);var o=e[a][t],i=function(t){var n=0,r=!0,a=!1,i=void 0;try{for(var c,u=t[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var l=c.value;if(l.x<0||l.x>=e[0].length||l.y<0||l.y>=e.length||e[l.y][l.x]!==o)break;++n}}catch(s){a=!0,i=s}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n},c=f.a.mark(function e(t,n,r,a){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,{x:t+=r,y:n+=a};case 3:e.next=0;break;case 5:case"end":return e.stop()}},e,this)}),u=function(e,n){return i(c(t,a,-e,-n))+i(c(t,a,e,n))+1};return u(0,1)>=n||u(1,0)>=n||u(1,1)>=n||u(1,-1)>=n},v=6,O=7,j=4,g={grid:d(O,v),currentPlayer:r.PlayerA,winner:r.None,history:{past:[],future:[]}},E=function(e,t){if(e.winner!==r.None)throw new Error("Game is over, a player already won");var n=b(e.grid,t,e.currentPlayer),a=m(n,t,j);return Object(h.a)({},e,{grid:n,currentPlayer:e.currentPlayer===r.PlayerA?r.PlayerB:r.PlayerA,winner:a?e.currentPlayer:r.None,history:{past:[t].concat(Object(p.a)(e.history.past)),future:[]}})},P=Object(l.combineReducers)({connectFour:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_GAME":return Object(h.a)({},e,{grid:d(O,v),winner:r.None,history:{past:[],future:[]}});case"PLAY_AT":var n=t.payload.columnIdx;return E(e,n);case"REPLAY_ALL":var a=t.payload.columns,o=Object(h.a)({},e,{grid:d(O,v),winner:r.None,history:{past:[],future:[]}});return a.reduce(function(e,t){return E(e,t)},o);case"CANCEL_MOVE":if(0===e.history.past.length)throw new Error("Unable to undo operation, no more history available");var i=Object(s.a)(e.history.past),c=i[0],u=i.slice(1),l=function(e,t){for(var n=0;n!==e.length;++n)if(e[n][t]!==r.None){var a=Object(p.a)(e).map(function(e){return Object(p.a)(e)});return a[n][t]=r.None,a}throw new Error("Unable to unplay: invalid position")}(e.grid,c);return Object(h.a)({},e,{grid:l,currentPlayer:e.currentPlayer===r.PlayerA?r.PlayerB:r.PlayerA,winner:r.None,history:{past:u,future:[c].concat(Object(p.a)(e.history.future))}});case"REDO_MOVE":if(0===e.history.future.length)throw new Error("Unable to redo operation, no more history available");var y=Object(s.a)(e.history.future),f=y[0],P=y.slice(1),A=b(e.grid,f,e.currentPlayer),k=m(A,f,j);return Object(h.a)({},e,{grid:A,currentPlayer:e.currentPlayer===r.PlayerA?r.PlayerB:r.PlayerA,winner:k?e.currentPlayer:r.None,history:{past:[f].concat(Object(p.a)(e.history.past)),future:P}});default:return e}}}),A=n(69),k=Object(l.createStore)(P,Object(A.devToolsEnhancer)({})),w=(n(87),n(7)),N=n(8),C=n(10),S=n(9),G=n(11),F=(n(89),function(){return{type:"NEW_GAME",payload:null}}),M=function(e){return{type:"PLAY_AT",payload:{columnIdx:e}}},U=function(e){return{type:"REPLAY_ALL",payload:{columns:e}}},z=function(){return{type:"CANCEL_MOVE",payload:null}},x=function(){return{type:"REDO_MOVE",payload:null}},L=(n(91),n(93),n(95),function(e){function t(){return Object(w.a)(this,t),Object(C.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(G.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"board-cell player-".concat(this.props.player)})}}]),t}(o.a.Component)),W=function(e){function t(){return Object(w.a)(this,t),Object(C.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(G.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"board-column ".concat(this.props.playable?"playable":"not-playable"),onClick:this.props.playable?this.props.onClick:void 0},this.props.tokens.map(function(e,t){return o.a.createElement(L,{key:t,player:e})}))}}]),t}(o.a.Component),_=function(e){function t(){return Object(w.a)(this,t),Object(C.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(G.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){for(var e=this,t=[],n=function(n){var a=e.props.grid[0][n]===r.None&&!e.props.done,i=e.props.grid.map(function(e){return e[n]});t.push(o.a.createElement(W,{key:n,playable:a,tokens:i,onClick:a?function(){return e.props.playAt(n)}:void 0}))},a=0;a!==this.props.grid[0].length;++a)n(a);return o.a.createElement("div",{className:"board player-"+this.props.currentPlayer},t)}}]),t}(o.a.Component);var R=Object(u.b)(function(e){return{grid:e.connectFour.grid,currentPlayer:e.connectFour.currentPlayer,done:e.connectFour.winner!==r.None}},function(e){return Object(h.a)({},Object(l.bindActionCreators)({playAt:M},e))})(_),B=(n(97),n(70)),D=n.n(B),J=n(72),V=n.n(J),Y=n(71),I=n.n(Y),T=n(41),Z=n.n(T),q=function(e){function t(){return Object(w.a)(this,t),Object(C.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(G.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(Z.a,{id:"undo-button",variant:"contained",onClick:function(){return e.props.cancelMove()},disabled:!this.props.canUndo},o.a.createElement(D.a,null)),o.a.createElement(Z.a,{id:"new-game-button",variant:"contained",onClick:function(){return e.props.newGame()}},"New Game ",o.a.createElement(I.a,null)),o.a.createElement(Z.a,{id:"redo-button",variant:"contained",onClick:function(){return e.props.redoMove()},disabled:!this.props.canRedo},o.a.createElement(V.a,null)))}}]),t}(o.a.Component);var H=Object(u.b)(function(e){return{canUndo:e.connectFour.history.past.length>0,canRedo:e.connectFour.history.future.length>0}},function(e){return Object(h.a)({},Object(l.bindActionCreators)({newGame:F,cancelMove:z,redoMove:x},e))})(q),K=(n(187),function(e){function t(){return Object(w.a)(this,t),Object(C.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(G.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){var e=this.props,t=e.winner,n=e.currentPlayer;return t!==r.None?o.a.createElement("div",{className:"instructions victory player-".concat(t)},"Player #",t," won"):o.a.createElement("div",{className:"instructions player-".concat(n)},"Player #",n," turn")}}]),t}(o.a.Component));var Q,X=Object(u.b)(function(e){return{currentPlayer:e.connectFour.currentPlayer,winner:e.connectFour.winner}},function(e){return Object(h.a)({},Object(l.bindActionCreators)({},e))})(K),$=(n(189),n(195)),ee=n(196);!function(e){e.None="None",e.Game="Game",e.Manual="Manual"}(Q||(Q={}));var te=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(C.a)(this,Object(S.a)(t).call(this,e))).state={onGoingWork:Q.None},n}return Object(G.a)(t,e),Object(N.a)(t,[{key:"componentDidMount",value:function(){var e=t.serializeStateFromProps(this.props);if(this.props.location.pathname!==e){var n=t.parseState(this.props.location.pathname);return this.props.replayAll(n.columns),void this.setState({onGoingWork:Q.Manual,redirectUrl:t.serializeStateFromParsed(n)})}}},{key:"componentDidUpdate",value:function(e){if(this.state.onGoingWork!==Q.Game)if(this.state.onGoingWork!==Q.Manual){var n=t.serializeStateFromProps(e),r=t.serializeStateFromProps(this.props);if(r===n){if(this.props.location.pathname!==e.location.pathname){var a=t.parseState(this.props.location.pathname);return this.props.replayAll(a.columns),void this.setState({onGoingWork:Q.Manual,redirectUrl:t.serializeStateFromParsed(a)})}}else this.setState({onGoingWork:Q.Game,redirectUrl:r})}else{var o=t.serializeStateFromProps(this.props);this.props.location.pathname===this.state.redirectUrl&&this.state.redirectUrl===o&&this.setState({onGoingWork:Q.None})}else this.props.location.pathname===this.state.redirectUrl&&this.setState({onGoingWork:Q.None})}},{key:"render",value:function(){return this.state.onGoingWork===Q.None||this.state.redirectUrl===this.props.location.pathname?o.a.createElement("div",{className:"url"},o.a.createElement("b",null,"URL:")," ",this.props.location.pathname):o.a.createElement($.a,{to:this.state.redirectUrl})}}],[{key:"parseState",value:function(e){return{columns:e.substring(1).split("").reduce(function(e,t){var n,r="A"<=(n=t)&&n<="Z"?n.charCodeAt(0)-"A".charCodeAt(0):"a"<=n&&n<="z"?n.charCodeAt(0)-"a".charCodeAt(0)+26:"0"<=n&&n<="9"?n.charCodeAt(0)-"0".charCodeAt(0)+52:"+"===n?62:63;return r<8?(e.push(r-1),console.log(JSON.stringify(e))):(e.push(Math.floor(r/8)-1),e.push(r%8-1),console.log(JSON.stringify(e))),e},[]).reverse()}}},{key:"serializeState",value:function(e){return"/"+e.reduce(function(e,t){return e[e.length-1]<8?(e[e.length-1]*=8,e[e.length-1]+=t+1):e.push(t+1),e},[]).map(function(e){return e<26?String.fromCodePoint(e+65):e<52?String.fromCodePoint(e+97-26):e<62?String.fromCodePoint(e+48-52):62===e?"+":"/"}).join("")}},{key:"serializeStateFromParsed",value:function(e){return this.serializeState(e.columns.reverse())}},{key:"serializeStateFromProps",value:function(e){return this.serializeState(e.connectFour.history.past)}}]),t}(o.a.Component);var ne=Object(ee.a)(Object(u.b)(function(e){return e},function(e){return Object(h.a)({},Object(l.bindActionCreators)({replayAll:U},e))})(te)),re=function(e){function t(){return Object(w.a)(this,t),Object(C.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(G.a)(t,e),Object(N.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"connect-four-app"},o.a.createElement(ne,null),o.a.createElement(X,null),o.a.createElement(R,null),o.a.createElement(H,null))}}]),t}(a.Component),ae=n(194),oe=n(193),ie=document.getElementById("root");c.a.render(o.a.createElement(u.a,{store:k},o.a.createElement(ae.a,null,o.a.createElement(oe.a,{path:"/:state?",component:re}))),ie)},74:function(e,t,n){e.exports=n(192)},87:function(e,t,n){},89:function(e,t,n){},91:function(e,t,n){},93:function(e,t,n){},95:function(e,t,n){},97:function(e,t,n){}},[[74,2,1]]]);
//# sourceMappingURL=main.d68dffb5.chunk.js.map